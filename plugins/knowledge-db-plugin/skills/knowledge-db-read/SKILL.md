---
name: knowledge-db-read
description: ナレッジDB（GitHub リポジトリ EraX-1/knowledge_db）から知識を検索・取得して回答に活用するスキル。ユーザーが「ナレッジDBから取得して」「ナレッジを参照して」「ナレッジDBを確認して」「知識ベースから探して」「ナレッジDB見て」「過去のナレッジを調べて」「ナレッジから情報を引いて」などと言ったときに使用する。蓄積済みの技術的知見やトラブルシュート記録を検索し、回答の根拠として活用する。質問に技術的な背景知識が必要で、ナレッジDBに関連情報がありそうな場合にも積極的に使うこと。
---

# ナレッジDB読み取りスキル

## リポジトリ情報

- **リポジトリ**: `EraX-1/knowledge_db`
- **ブランチ**: `main`
- **操作手段**: `gh` CLIコマンド（読み取り専用）

## ワークフロー

ナレッジを参照する際は、以下の手順で実行する。探索と取得は並列エージェント（Taskツール）を活用して高速化すること。

### 1. 質問のキーワード抽出

ユーザーの質問から、検索に使うキーワードや技術領域を特定する：

- **技術領域**（例: AI、RAG、OCR、デプロイ、データベース）
- **具体的な技術名**（例: AssemblyAI、MongoDB、Azure）
- **問題の種類**（例: 精度改善、パフォーマンス、設定方法）

### 2. ディレクトリ構造の探索（並列エージェント）

Taskツール（subagent_type: Bash）を使って並列でリポジトリ構造を探索する。まずディレクトリ一覧とファイル一覧を同時に取得する：

```bash
# ディレクトリ構造の全体取得
gh api 'repos/EraX-1/knowledge_db/git/trees/main?recursive=1' --jq '.tree[] | .path'
```

取得した構造から、質問に関連するディレクトリとファイルを特定する。ディレクトリ名・ファイル名から関連性を判断する。

関連性の判断基準：
- ディレクトリ名がキーワードと一致または類似する（例: 質問が「文字起こし」→ `ai/speech-to-text/`）
- ファイル名にキーワードが含まれる（例: 質問が「AssemblyAI」→ `assemblyai-accuracy-tuning.md`）
- 広めに候補を拾い、該当しそうなファイルは複数あっても全て取得する

### 3. 関連ドキュメントの取得（並列エージェント）

候補が複数ある場合、並列エージェントで同時にfetchする。各エージェントに1ファイルずつ取得させる：

```bash
# ファイル内容の取得（base64デコード）
gh api 'repos/EraX-1/knowledge_db/contents/<ファイルパス>' --jq '.content' | base64 -d
```

取得するファイル数の目安：
- **関連性が高いファイル**: 最大5件まで並列取得
- **関連性が不明だが候補になるファイル**: ファイル名で判断し、迷ったら取得する（取得して不要だった方が、取得せず情報が欠けるより良い）

### 4. 情報の統合と回答

取得したナレッジを基に回答を構成する：

- 取得した情報を質問の文脈に合わせて要約・整理する
- ナレッジの内容をそのまま貼り付けるのではなく、質問に対する回答として再構成する
- 回答の最後に、参照したナレッジのソースを明示する：

```
**参照ナレッジ:**
- [ファイル名](https://github.com/EraX-1/knowledge_db/blob/main/<パス>)
```

### 5. ナレッジが見つからない場合

関連するナレッジが見つからなかった場合：
- ナレッジDBに該当する情報がなかったことをユーザーに伝える
- 自身の知識で回答できる場合はその旨を添えて回答する
- 必要に応じて「この知識をナレッジDBに蓄積しますか？」と提案する

## 並列実行のパターン

探索と取得を効率化するため、以下のように並列エージェントを活用する：

### パターン1: 構造探索 → 並列fetch

```
[メインエージェント]
  │
  ├── gh api でツリー構造を取得（1回のAPI呼び出し）
  │
  ├── 関連ファイルを特定
  │
  └── 並列Taskエージェントで同時fetch
       ├── Task: fetch ai/rag/hyde.md
       ├── Task: fetch ai/rag/chunking-strategies.md
       └── Task: fetch ai/speech-to-text/assemblyai-accuracy-tuning.md
```

### パターン2: キーワードが明確な場合

質問のキーワードから直接ファイルパスを推測できる場合でも、必ずツリー構造を先に確認する。推測だけでファイルを取得しに行くと、存在しないパスへのリクエストで時間を無駄にする。

## 重要なルール

1. **推測でファイルパスを決めない** — 必ずツリー構造を確認してからファイルを取得する
2. **並列エージェントを活用する** — 複数ファイルの取得は並列で行い、応答速度を上げる
3. **広めに候補を拾う** — 関連しそうなファイルは迷ったら取得する。情報が多い方が回答の質が上がる
4. **ソースを明示する** — 回答の根拠となったナレッジファイルへのリンクを必ず記載する
5. **読み取り専用** — このスキルではリポジトリへの書き込みは一切行わない
